TODO:

 1. add conditional compilation to headers for C++ compiling
 2.